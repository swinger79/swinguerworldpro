{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///Users/technoandcompany/swinguerworldpro/apps/web/pages/chat.js"],"sourcesContent":["import { useEffect, useState, useRef } from 'react';\nimport { useRouter } from 'next/router';\n\nexport default function Chat() {\n  const router = useRouter();\n  const [user, setUser] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [onlineUsers, setOnlineUsers] = useState(0);\n  const ws = useRef(null);\n\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    const userData = localStorage.getItem('user');\n\n    if (!token) {\n      router.push('/login');\n      return;\n    }\n\n    const currentUser = JSON.parse(userData);\n    setUser(currentUser);\n\n    // Conectar WebSocket\n    ws.current = new WebSocket('ws://localhost:3001');\n\n    ws.current.onopen = () => {\n      console.log('‚úÖ WebSocket conectado');\n      // Notificar que el usuario se uni√≥\n      ws.current.send(JSON.stringify({\n        type: 'join',\n        userId: currentUser.id,\n        userName: currentUser.name\n      }));\n    };\n\n    ws.current.onmessage = (event) => {\n      const data = JSON.parse(event.data);\n\n      if (data.type === 'new_message') {\n        setMessages(prev => [...prev, data.data]);\n      }\n\n      if (data.type === 'user_joined') {\n        console.log(`${data.userName} se conect√≥`);\n      }\n\n      if (data.type === 'user_left') {\n        console.log('Un usuario se desconect√≥');\n      }\n    };\n\n    return () => {\n      ws.current?.close();\n    };\n  }, [router]);\n\n  const handleSendMessage = (e) => {\n    e.preventDefault();\n    if (!newMessage.trim() || !user) return;\n\n    ws.current.send(JSON.stringify({\n      type: 'message',\n      userId: user.id,\n      userName: user.name,\n      text: newMessage\n    }));\n\n    setNewMessage('');\n  };\n\n  if (!user) return <p>‚è≥ Cargando...</p>;\n\n  return (\n    <div style={{\n      display: 'flex',\n      flexDirection: 'column',\n      height: '100vh',\n      fontFamily: 'Arial'\n    }}>\n      {/* Header */}\n      <div style={{\n        padding: '15px 20px',\n        background: '#007bff',\n        color: 'white',\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center'\n      }}>\n        <h2>üí¨ Chat Global</h2>\n        <button\n          onClick={() => {\n            localStorage.removeItem('token');\n            localStorage.removeItem('user');\n            router.push('/login');\n          }}\n          style={{\n            padding: '8px 16px',\n            background: '#dc3545',\n            color: 'white',\n            border: 'none',\n            borderRadius: '5px',\n            cursor: 'pointer'\n          }}\n        >\n          Salir\n        </button>\n      </div>\n\n      {/* Mensajes */}\n      <div style={{\n        flex: 1,\n        overflowY: 'auto',\n        padding: '20px',\n        background: '#f9f9f9'\n      }}>\n        {messages.length === 0 ? (\n          <p style={{ textAlign: 'center', color: '#999' }}>\n            S√© el primero en enviar un mensaje üëã\n          </p>\n        ) : (\n          messages.map((msg) => (\n            <div key={msg.id} style={{\n              marginBottom: '15px',\n              display: 'flex',\n              gap: '10px',\n              animation: 'slideIn 0.3s ease'\n            }}>\n              <img\n                src={msg.avatar}\n                alt={msg.userName}\n                style={{\n                  width: '40px',\n                  height: '40px',\n                  borderRadius: '50%'\n                }}\n              />\n              <div>\n                <strong>{msg.userName}</strong>\n                <br />\n                <div style={{\n                  background: 'white',\n                  padding: '10px 15px',\n                  borderRadius: '8px',\n                  marginTop: '5px',\n                  maxWidth: '500px'\n                }}>\n                  {msg.text}\n                </div>\n                <small style={{ color: '#999' }}>\n                  {new Date(msg.timestamp).toLocaleTimeString()}\n                </small>\n              </div>\n            </div>\n          ))\n        )}\n      </div>\n\n      {/* Input */}\n      <form onSubmit={handleSendMessage} style={{\n        padding: '20px',\n        background: 'white',\n        borderTop: '1px solid #ddd',\n        display: 'flex',\n        gap: '10px'\n      }}>\n        <input\n          type=\"text\"\n          value={newMessage}\n          onChange={(e) => setNewMessage(e.target.value)}\n          placeholder=\"Escribe un mensaje...\"\n          style={{\n            flex: 1,\n            padding: '10px',\n            border: '1px solid #ddd',\n            borderRadius: '5px',\n            fontSize: '14px'\n          }}\n        />\n        <button\n          type=\"submit\"\n          style={{\n            padding: '10px 20px',\n            background: '#007bff',\n            color: 'white',\n            border: 'none',\n            borderRadius: '5px',\n            cursor: 'pointer',\n            fontSize: '14px'\n          }}\n        >\n          Enviar\n        </button>\n      </form>\n\n      <style jsx>{`\n        @keyframes slideIn {\n          from {\n            opacity: 0;\n            transform: translateY(10px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n      `}</style>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}